{"version":3,"file":"model.js","sources":["js/model/abstractModel.js","js/config/config.js","js/model/model.js"],"sourcesContent":["class AbstractAdapter {\n  toServer() {\n    throw Error(`Abstract method. Define toServer method`);\n  }\n}\n\nconst defaultAdapter = new class extends AbstractAdapter {\n  toServer(data) {\n    return JSON.stringify(data);\n  }\n}();\n\nclass AbstractModel {\n  get urlRead() {\n    throw new Error(`You have to define urlRead`);\n  }\n\n  get urlWrite() {\n    throw new Error(`You have to define urlWrite`);\n  }\n\n  get initialState() {\n    throw new Error(`You have to define initialState`);\n  }\n\n  load() {\n    return fetch(this.urlRead)\n        .then((response) => response.json())\n        .catch((error) => console.error(error));\n  }\n\n  save(data, adapter = defaultAdapter) {\n    console.log(adapter.toServer(data));\n    return fetch(this.urlWrite, {\n      method: `POST`,\n      body: adapter.toServer(data),\n      headers: {\n        'Content-Type': `application/json`\n      }\n    });\n  }\n}\n\nexport default AbstractModel;\n","const NUM_OF_LIVES = 3;\nconst TIME_PER_SCREEN = 30;\nconst POINTS_FOR_RIGHT_ANSWER = 100;\nconst BONUS_POINTS_FOR_SPEED = 50;\nconst BONUS_POINTS_FOR_LIVE = 50;\nconst PENALTY_FOR_SLOWNESS = 50;\nconst SLOW_ANSWER_TIME_BOTTOM_LIMIT = 20;\nconst FAST_ASWER_TIME_UPPER_LIMIT = 10;\nconst NUM_OF_QUESTIONS = 10;\nconst API_URL = `https://es.dump.academy/pixel-hunter`;\n\nconst QuestionType = {\n  TWO_OF_TWO: `two-of-two`,\n  TINDER_LIKE: `tinder-like`,\n  ONE_OF_THREE: `one-of-three`\n};\n\nconst Answer = {\n  FAIL: `fail`,\n  SLOW: `slow`,\n  NORMAL: `right`,\n  FAST: `fast`\n};\nconst Result = {\n  LOSS: `loss`,\n  WIN: `win`\n};\n\nconst AnswerType = {\n  PAINTING: `painting`,\n  PHOTO: `photo`\n};\n\nexport {\n  NUM_OF_LIVES,\n  TIME_PER_SCREEN,\n  POINTS_FOR_RIGHT_ANSWER,\n  BONUS_POINTS_FOR_SPEED,\n  BONUS_POINTS_FOR_LIVE,\n  PENALTY_FOR_SLOWNESS,\n  SLOW_ANSWER_TIME_BOTTOM_LIMIT,\n  FAST_ASWER_TIME_UPPER_LIMIT,\n  NUM_OF_QUESTIONS,\n  API_URL,\n  QuestionType,\n  AnswerType,\n  Answer,\n  Result\n};\n","import AbstractModel from './abstractModel';\nimport * as constants from '../config/config';\n\nclass Model extends AbstractModel {\n  get urlRead() {\n    return `${constants.API_URL}/questions`;\n  }\n\n  get urlWrite() {\n    return `${constants.API_URL}/stats/:Andron1`;\n  }\n\n  get statsUrlRead() {\n    return `${constants.API_URL}/stats/:Andron1`;\n  }\n\n  get initialState() {\n    return {\n      name: null,\n      result: null,\n      time: constants.TIME_PER_SCREEN,\n      lives: constants.NUM_OF_LIVES,\n      answers: [],\n      questionNumber: 0,\n      questions: null,\n      stats: null\n    };\n  }\n\n  get state() {\n    if (!this._state) {\n      this._state = this.initialState;\n    }\n\n    return this._state;\n  }\n\n  set state(anotherState) {\n    this._state = anotherState;\n  }\n\n  resetState(gameItems) {\n    this.state = gameItems ? Object.assign({}, this.initialState, {questions: gameItems}) : this.initialState;\n  }\n\n  load() {\n    return super.load()\n        .then((data) => {\n          this.state.questions = data;\n\n          return this.loadStatistics();\n        });\n  }\n\n  loadStatistics() {\n    return fetch(this.statsUrlRead)\n        .then((response) => response.json())\n        .then((data) => {\n          this.state.stats = data;\n        });\n  }\n\n  changeState(answer) {\n    const time = this.initialState.time - this.state.time;\n    let result;\n\n    if (answer) {\n      if (time < constants.FAST_ASWER_TIME_UPPER_LIMIT) {\n        result = constants.Answer.FAST;\n      } else if (time >= constants.SLOW_ANSWER_TIME_BOTTOM_LIMIT) {\n        result = constants.Answer.SLOW;\n      } else {\n        result = constants.Answer.NORMAL;\n      }\n    } else {\n      result = constants.Answer.FAIL;\n    }\n\n    this.state = Object.assign({}, this.state, {\n      questionNumber: this.state.questionNumber + 1,\n      lives: this.state.lives - (answer ? 0 : 1),\n      answers: this.state.answers.concat(result),\n      time: this.initialState.time\n    });\n\n    if (!this.state.lives) {\n      this.state = Object.assign({}, this.state, {\n        result: constants.Result.LOSS\n      });\n    } else if (this.state.questionNumber === this.state.questions.length) {\n      this.state = (Object.assign({}, this.state, {\n        result: constants.Result.WIN\n      }));\n    }\n\n    return this.state;\n  }\n}\n\nexport default Model;\n"],"names":["constants.API_URL","constants.TIME_PER_SCREEN","constants.NUM_OF_LIVES","constants.FAST_ASWER_TIME_UPPER_LIMIT","constants.Answer","constants.SLOW_ANSWER_TIME_BOTTOM_LIMIT","constants.Result"],"mappings":"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"}